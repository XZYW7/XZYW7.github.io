<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  
  
  <title>
    【笔记】Cherno Opengl Tutorial note 03 |
    
    XZYW7&#39;s Blog
  </title>
  <!-- Icon -->
  
    <link rel="shortcut icon" href="/favicon.ico">
    
  
<link rel="stylesheet" href="/css/style.css">

  
  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<script src="/js/pace.min.js"></script>

<meta name="generator" content="Hexo 7.3.0"></head>

<body>
  <main class="content">
    <section class="outer">
  <article id="post-TA/OpenGL/Opengl learning_03" class="article article-type-post" itemscope
  itemprop="blogPost" data-scroll-reveal>

  <div class="article-inner">
    
    <header class="article-header">
      
  
  <h1 class="article-title" itemprop="name">
    【笔记】Cherno Opengl Tutorial note 03
  </h1>
  
  

    </header>
    

    
    <div class="article-meta">
      <a href="/2022/09/12/TA/OpenGL/Opengl%20learning_03/" class="article-date">
  <time datetime="2022-09-12T04:05:40.000Z" itemprop="datePublished">2022-09-12</time>
</a>
      
    </div>
    

    
    
<div class="tocbot"></div>

    

    <div class="article-entry" itemprop="articleBody">
      
      
      
        <h2 id="16-Writing-a-Basic-Renderer"><a href="#16-Writing-a-Basic-Renderer" class="headerlink" title="16 Writing a Basic Renderer"></a><strong>16 Writing a Basic Renderer</strong></h2><p>目前为止，如果我们每次想要绘制东西，都需要完成所有步骤-绑定-drawcall</p>
<p>希望能够提供</p>
<p>Renderer</p>
<p>unbind不是绝对的，但在debug中很有用，也许也能减少一些错误。但是实际上没有必要要，因为绑定下一个对象，就等于解绑了。</p>
<h3 id="Renderer"><a href="#Renderer" class="headerlink" title="Renderer"></a><strong>Renderer</strong></h3><p>要注意Renderer.h这里有一些小坑，就是作者include了VertexArray.h，其中又include了VertexBufferLayout。但是之前为了方便把debug的函数写在了Renderer当中，导致这里出现了相互include。解决方法就是把VertexArray.h中对VertexBufferLayout的include去掉，改成对这个class的声明，然后因为VertexArray.h还是需要使用其内部方法，在VertexArray.cpp 中再include VertexBufferLayout。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Renderer.h</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> once</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;GL/glew.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;VertexArray.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;IndexBuffer.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Shader.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ASSERT(x) <span class="keyword">if</span> (!(x)) __debugbreak();<span class="comment">//MSVC function</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> GLCall(x) GLClearError();\</span></span><br><span class="line"><span class="meta">    x;\</span></span><br><span class="line"><span class="meta">	ASSERT(GLLogCall(#x, __FILE__, __LINE__))<span class="comment">//#把x转换成字符串 </span></span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">GLClearError</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">GLLogCall</span><span class="params">(<span class="type">const</span> <span class="type">char</span>* function, <span class="type">const</span> <span class="type">char</span>* file, <span class="type">int</span> line)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Renderer</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">Clear</span><span class="params">()</span> <span class="type">const</span></span>; </span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">Draw</span><span class="params">(<span class="type">const</span> VertexArray&amp; va, <span class="type">const</span> IndexBuffer&amp; ib, <span class="type">const</span> Shader&amp; shader)</span> <span class="type">const</span></span>;</span><br><span class="line">	<span class="comment">//vertex array, index buffer, shader</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Renderer.cpp</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Renderer.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">GLClearError</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">glGetError</span>() != GL_NO_ERROR);<span class="comment">//!glGetError()</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">GLLogCall</span><span class="params">(<span class="type">const</span> <span class="type">char</span>* function, <span class="type">const</span> <span class="type">char</span>* file, <span class="type">int</span> line)</span> </span>&#123;<span class="comment">//提供函数名与文件名以及行数</span></span><br><span class="line">    <span class="keyword">while</span> (GLenum error = <span class="built_in">glGetError</span>()) &#123;</span><br><span class="line">        std::cout &lt;&lt; <span class="string">&quot;[OpenGL Error] (&quot;</span> &lt;&lt; error &lt;&lt; <span class="string">&quot;): &quot;</span> &lt;&lt; function &lt;&lt;</span><br><span class="line">            <span class="string">&quot; &quot;</span> &lt;&lt; file &lt;&lt; <span class="string">&quot; : &quot;</span> &lt;&lt; line &lt;&lt; std::endl;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Renderer::Clear</span><span class="params">()</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">glClear</span>(GL_COLOR_BUFFER_BIT);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Renderer::Draw</span><span class="params">(<span class="type">const</span> VertexArray&amp; va, <span class="type">const</span> IndexBuffer&amp; ib, <span class="type">const</span> Shader&amp; shader)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    shader.<span class="built_in">Bind</span>();</span><br><span class="line"></span><br><span class="line">    va.<span class="built_in">Bind</span>();</span><br><span class="line">    ib.<span class="built_in">Bind</span>();</span><br><span class="line">    <span class="built_in">GLCall</span>(<span class="built_in">glDrawElements</span>(GL_TRIANGLES, ib.<span class="built_in">GetCount</span>(), GL_UNSIGNED_INT, <span class="literal">nullptr</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>drawcall</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> (!<span class="built_in">glfwWindowShouldClose</span>(window))</span><br><span class="line">&#123;</span><br><span class="line">    renderer.<span class="built_in">Clear</span>();</span><br><span class="line">    <span class="comment">/* Render here */</span></span><br><span class="line">    shader.<span class="built_in">Bind</span>();</span><br><span class="line">    shader.<span class="built_in">SetUniform4f</span>(<span class="string">&quot;u_Color&quot;</span>, r, <span class="number">0.3f</span>, <span class="number">0.8f</span>, <span class="number">1.0f</span>);</span><br><span class="line">    renderer.<span class="built_in">Draw</span>(va, ib, shader);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (r &gt; <span class="number">1.0f</span>)</span><br><span class="line">        increment = <span class="number">-0.05f</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (r &lt; <span class="number">0.0f</span>)</span><br><span class="line">        increment = <span class="number">0.05f</span>;</span><br><span class="line">    r += increment;</span><br><span class="line">    <span class="comment">/* Swap front and back buffers */</span></span><br><span class="line">    <span class="built_in">glfwSwapBuffers</span>(window);</span><br><span class="line">    <span class="comment">/* Poll for and process events */</span></span><br><span class="line">    <span class="built_in">glfwPollEvents</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这样我们在renderer当中有顶点数组和索引缓冲区以及一个shader。</p>
<p>但是相比于shader，在传统的渲染器中采用的是材质material。材质就是shader加上一组数据（uniforms）。</p>
<p>这样将material传递给renderer，它将直接把shader和uniform绑定，然后再进行drawcall。。。</p>
<p>在本教程中也许不会涉及，但是在Game Engine中一定需要做。</p>
<h2 id="17-Textures"><a href="#17-Textures" class="headerlink" title="17 Textures"></a><strong>17 Textures</strong></h2><p>我们会忽略游戏中使用的纹理格式，但反正肯定不是png</p>
<ul>
<li>将图片加载到cpu memory</li>
<li>将pixel array 传递到GPU</li>
<li>使用shader读取到texture</li>
</ul>
<p>我们这里将会使用#include &lt;stb_image.h&gt;来处理png图片</p>
<p><a target="_blank" rel="noopener" href="https://github.com/nothings/stb/blob/master/stb_image.h">stb&#x2F;stb_image.h at master · nothings&#x2F;stb (github.com)</a></p>
<p>(直接拿图形学课的框架里的用了)，我们实际上只需要使用stb_image.h</p>
<p>在项目中新建stb_image.h和stb_image.cpp文件，把头文件直接复制进去，并且根据注释说明，在cpp文件中添加</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> STB_IMAGE_IMPLEMENTATION</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;stb_image.h&quot;</span></span></span><br></pre></td></tr></table></figure>

<p>这样就可以使用了。</p>
<p>然后我们要添加texture类</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Texture.h</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> once</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Renderer.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Texture</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> m_RendererID;</span><br><span class="line">	std::string m_FilePath;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span>* m_LocalBuffer;</span><br><span class="line">	<span class="type">int</span> m_Width, m_Height, m_BPP;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">Texture</span>(<span class="type">const</span> std::string&amp; path);</span><br><span class="line">	~<span class="built_in">Texture</span>();</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">Bind</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> slot = <span class="number">0</span>)</span> <span class="type">const</span></span>;</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">Unbind</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line">	<span class="comment">// windows有32个 slot，移动平台如iphone有8个slot，这取决于GPU</span></span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">GetWidth</span><span class="params">()</span> <span class="type">const</span> </span>&#123; <span class="keyword">return</span> m_Width; &#125;</span><br><span class="line">	<span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">GetHeight</span><span class="params">()</span> <span class="type">const</span> </span>&#123; <span class="keyword">return</span> m_Height; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>Texture.cpp</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Texture.cpp</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Texture.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;vendor/stb_image/stb_image.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Texture::<span class="built_in">Texture</span>(<span class="type">const</span> std::string&amp; path)</span><br><span class="line">	: <span class="built_in">m_RendererID</span>(<span class="number">0</span>),	<span class="built_in">m_FilePath</span>(path), 	<span class="built_in">m_LocalBuffer</span>(<span class="literal">nullptr</span>), </span><br><span class="line">	<span class="built_in">m_Width</span>(<span class="number">0</span>),	<span class="built_in">m_Height</span>(<span class="number">0</span>), <span class="built_in">m_BPP</span>(<span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">stbi_set_flip_vertically_on_load</span>(<span class="number">1</span>);</span><br><span class="line">	<span class="comment">//opengl希望pixel坐标从bottom-left开始</span></span><br><span class="line">	<span class="comment">//通常以扫描线的方式加载图片，左上角是起始点</span></span><br><span class="line"></span><br><span class="line">	m_LocalBuffer = <span class="built_in">stbi_load</span>(path.<span class="built_in">c_str</span>(), &amp;m_Width, &amp;m_Height, &amp;m_BPP, <span class="number">4</span>);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">GLCall</span>(<span class="built_in">glGenTextures</span>(<span class="number">1</span>, &amp;m_RendererID));</span><br><span class="line">	<span class="built_in">GLCall</span>(<span class="built_in">glBindTexture</span>(GL_TEXTURE_2D, m_RendererID));</span><br><span class="line"></span><br><span class="line">	<span class="built_in">GLCall</span>(<span class="built_in">glTexParameteri</span>(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR));</span><br><span class="line">	<span class="built_in">GLCall</span>(<span class="built_in">glTexParameteri</span>(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR));</span><br><span class="line">	<span class="built_in">GLCall</span>(<span class="built_in">glTexParameteri</span>(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_CLAMP_TO_EDGE));</span><br><span class="line">	<span class="built_in">GLCall</span>(<span class="built_in">glTexParameteri</span>(GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_CLAMP_TO_EDGE));</span><br><span class="line"></span><br><span class="line">	<span class="built_in">GLCall</span>(<span class="built_in">glTexImage2D</span>(GL_TEXTURE_2D, <span class="number">0</span>, GL_RGBA8, m_Width, m_Height, <span class="number">0</span>, GL_RGBA, GL_UNSIGNED_BYTE, m_LocalBuffer));</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">GLCall</span>(<span class="built_in">glBindTexture</span>(GL_TEXTURE_2D, <span class="number">0</span>));</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (m_LocalBuffer)</span><br><span class="line">		<span class="built_in">stbi_image_free</span>(m_LocalBuffer);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Texture::~<span class="built_in">Texture</span>()</span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">glDeleteTextures</span>(<span class="number">1</span>, &amp;m_RendererID);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Texture::Bind</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> slot)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">glActiveTexture</span>( GL_TEXTURE0 + slot);</span><br><span class="line">	<span class="built_in">glBindTexture</span>(GL_TEXTURE_2D, m_RendererID);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Texture::Unbind</span><span class="params">()</span> <span class="type">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">glBindTexture</span>(GL_TEXTURE_2D, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>这中间还有一些需要修改的，比如uniform、shader中的varying变量(in、out)</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">Shader::SetUniform1i</span><span class="params">(<span class="type">const</span> std::string&amp; name, <span class="type">int</span> value)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">glUniform1i</span>(<span class="built_in">GetUniformLocation</span>(name), value);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>当画出来的屏幕是黑的时候，加上GLCall()来debug就显得非常好用了</p>
<p>直接提示到我们</p>
<p>是这句发生了错误</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"> <span class="built_in">glTexImage2D</span>(GL_TEXTURE_2D, <span class="number">0</span>, GL_RGBA8, m_Width, m_Height, <span class="number">0</span>, GL_RGBA8, GL_UNSIGNED_BYTE, m_LocalBuffer);</span><br><span class="line"><span class="comment">//对照教程，需要改成</span></span><br><span class="line"><span class="built_in">glTexImage2D</span>(GL_TEXTURE_2D, <span class="number">0</span>, GL_RGBA8, m_Width, m_Height, <span class="number">0</span>, GL_RGBA, GL_UNSIGNED_BYTE, m_LocalBuffer);</span><br></pre></td></tr></table></figure>

<p>根据文档，这里两个format分别是internal format和format。internal format是opengl储存纹理的方法。format是提供的纹理的格式。所以我们提供GL_RGBA8告诉opengl储存单通道8位。而我们提供的纹理则是GL_RGBA格式的。</p>
<p>这样就非常完美地画出了薰。</p>
<p><img src="https://raw.githubusercontent.com/XZYW7/PicGo/main/img/image-20220911011136266.png" alt="image-20220911011136266"></p>
<p>(作者由于透明度混合设置的问题，图片出现了失真。)</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">glBlendFunc</span>(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);</span><br><span class="line"><span class="built_in">glEnable</span>(GL_BLEND);</span><br></pre></td></tr></table></figure>



<h2 id="18-Blending"><a href="#18-Blending" class="headerlink" title="18 Blending"></a><strong>18 Blending</strong></h2><p>Blending determines how we combine our output color with what is already in our target buffer.</p>
<ul>
<li>output<ul>
<li>the color we output from our fragment shader</li>
</ul>
</li>
<li>Target buffer<ul>
<li>the buffer our fs is drawing to (destination)</li>
</ul>
</li>
</ul>
<p>如何控制Blending</p>
<ul>
<li>glEnable(GL_BLEND)-glDisable(GL_BLEND)</li>
<li>glBlendFunc(src, dest)<ul>
<li>src &#x3D; how the src RGBA factor is computed(default is GL_ONE)</li>
<li>dest &#x3D; how the dest RGBA factor is computed(default is GL_ZERO)</li>
</ul>
</li>
<li>glBlendEquation(mode)（BlendOp）<ul>
<li>mode &#x3D; how we combine the src and dest colors</li>
<li>Defualt value is GL_FUNC_ADD</li>
</ul>
</li>
</ul>
<h2 id="19-Maths"><a href="#19-Maths" class="headerlink" title="19 Maths"></a><strong>19 Maths</strong></h2><p>ignored</p>
<p>在该教程中会使用glm（适用于opengl的数学库）。并且适配与opengl列主序的矩阵。</p>
<p>通常在我们自己写跨平台的引擎时，也会自己写数学库。可以是行主序的。</p>
<p><a target="_blank" rel="noopener" href="https://github.com/g-truc/glm/releases">Releases · g-truc&#x2F;glm (github.com)</a></p>
<p>我们可以在glm的git上下到release版，这里还是就直接把之前的复制到Dependencies里了。</p>
<p><img src="https://raw.githubusercontent.com/XZYW7/PicGo/main/img/image-20220911170351237.png" alt="image-20220911170351237"></p>
<p>实际上我们只需要glm文件夹里的东西。</p>
<p>作者把它也放进了vendor文件夹里。</p>
<p>（其实我也更倾向放到Dependencie里作为附加包含目录）</p>
<p>GLM也是一个只包含头文件的库，没有cpp文件，不需要编译</p>
<p>事实上，作者随后就把vendor文件夹放到了附加包含目录里。。。</p>
<h2 id="20-Projection-Matrices"><a href="#20-Projection-Matrices" class="headerlink" title="20 Projection Matrices"></a><strong>20 Projection Matrices</strong></h2><p>在projection中我们完成了归一化齐次坐标[-1,1]^3</p>
<p>略了</p>
<h2 id="21-Model-View-Projection-Matrices"><a href="#21-Model-View-Projection-Matrices" class="headerlink" title="21 Model View Projection Matrices"></a><strong>21 Model View Projection Matrices</strong></h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">glm::mat4 proj = glm::<span class="built_in">ortho</span>(<span class="number">-2.0f</span>, <span class="number">2.0f</span>, <span class="number">-1.5f</span>, <span class="number">1.5f</span>, <span class="number">-1.0f</span>, <span class="number">1.0f</span>);</span><br><span class="line">glm::mat4 view = glm::<span class="built_in">translate</span>(glm::<span class="built_in">mat4</span>(<span class="number">1.0f</span>), glm::<span class="built_in">vec3</span>(<span class="number">-1</span>, <span class="number">0</span>, <span class="number">0</span>));</span><br><span class="line">glm::mat4 model = glm::<span class="built_in">translate</span>(glm::<span class="built_in">mat4</span>(<span class="number">1.0f</span>), glm::<span class="built_in">vec3</span>(<span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>));</span><br><span class="line"></span><br><span class="line">glm::mat4 mvp = proj * view * model;</span><br></pre></td></tr></table></figure>

<p>在这里对view的处理很简单，就是我们向右移动相机，等同于向左移动物体。</p>
<h2 id="22-ImGui"><a href="#22-ImGui" class="headerlink" title="22 ImGui"></a><strong>22 ImGui</strong></h2><h3 id="环境配置"><a href="#环境配置" class="headerlink" title="环境配置"></a><strong>环境配置</strong></h3><p>这里只是简单地将imgui移植到我们的opengl中，</p>
<p><a target="_blank" rel="noopener" href="https://github.com/ocornut/imgui">ocornut&#x2F;imgui: Dear ImGui: Bloat-free Graphical User interface for C++ with minimal dependencies (github.com)</a></p>
<p>下载到release的source code</p>
<p>它提供了我们一个vs工程文件和一大堆各种平台的项目，我们也可以在这里面找到关于glfw_opengl3的example</p>
<img src="https://raw.githubusercontent.com/XZYW7/PicGo/main/img/image-20220911224925272.png" alt="image-20220911224925272" style="zoom:50%;" />

<p>而我们实际需要的是根目录下的那些头文件和cpp文件。总之我们把他们复制到vendor中的imgui文件夹，就可以用了。</p>
<p>我对比了一下这里的以及图形学课用的框架里的，多了这四个文件</p>
<p><img src="https://raw.githubusercontent.com/XZYW7/PicGo/main/img/image-20220911225155782.png" alt="image-20220911225155782"></p>
<p>可以看到这是imgui对glfw和opengl的实现（implementation）。在作者下载的imgui版本中，它们存在于examples当中（opengl3_example），但是我这里下载的版本已经更新了。</p>
<p>找了一下，它们已经更换了目录结构，现在这些impl文件都在backends文件夹中</p>
<p><img src="https://raw.githubusercontent.com/XZYW7/PicGo/main/img/image-20220911230018016.png" alt="image-20220911230018016"></p>
<p>所以我们还是得把这四个文件复制过去。</p>
<p>作者的版本当中的imgl_glfw使用了gl3w，有提示需要改成glew，但在我们这里没有这个问题。</p>
<p>但我们编译时会发现它新增了一个</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Modern desktop OpenGL doesn&#x27;t have a standard portable header file to load OpenGL function pointers.</span></span><br><span class="line"><span class="comment">// Helper libraries are often used for this purpose! Here we are using our own minimal custom loader based on gl3w.</span></span><br><span class="line"><span class="comment">// In the rest of your app/engine, you can use another loader of your choice (gl3w, glew, glad, glbinding, glext, glLoadGen, etc.).</span></span><br><span class="line"><span class="comment">// If you happen to be developing a new feature for this backend (imgui_impl_opengl3.cpp):</span></span><br><span class="line"><span class="comment">// - You may need to regenerate imgui_impl_opengl3_loader.h to add new symbols. See https://github.com/dearimgui/gl3w_stripped</span></span><br><span class="line"><span class="comment">// - You can temporarily use an unstripped version. See https://github.com/dearimgui/gl3w_stripped/releases</span></span><br><span class="line"><span class="comment">// Changes to this backend using new APIs should be accompanied by a regenerated stripped loader version.</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> IMGL3W_IMPL</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;imgui_impl_opengl3_loader.h&quot;</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>意思就是。。。他们还是自己搞了一个gl3w，并且封装在这个loader头文件中了。。。我们直接删掉这是两行换成glew，看看理解对不对</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;GL/glew.h&quot;</span></span></span><br></pre></td></tr></table></figure>

<p>如下</p>
<p><img src="https://raw.githubusercontent.com/XZYW7/PicGo/main/img/image-20220911234624507.png" alt="image-20220911234624507"></p>
<p>然而不对，这里后面会用到gl3w的api</p>
<p><a target="_blank" rel="noopener" href="https://github.com/ocornut/imgui/issues/4445">OpenGL 后端现在嵌入了自己的 GL 加载程序 （imgui_impl_opengl3_loader.h） ·问题 #4445 ·ocornut&#x2F;imgui (github.com)</a></p>
<p>后来感觉这样还是不行，loader里面就是对gl3w的实现了，我们应该直接换glew。因此注释掉上面两行以后，定位到接下来的问题</p>
<p><img src="https://raw.githubusercontent.com/XZYW7/PicGo/main/img/image-20220911233503486.png" alt="image-20220911233503486"></p>
<p>对于这里的初始化，我们直接给换成glewInit。这样就顺利运行了。</p>
<p>还是踩了些小坑，麻烦的话就直接跟着教程版本一致就好了。</p>
<h3 id="使用imgui"><a href="#使用imgui" class="headerlink" title="使用imgui"></a><strong>使用imgui</strong></h3><p>我们还是可以参考example中main里面的实现。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Setup Dear ImGui context</span></span><br><span class="line"><span class="built_in">IMGUI_CHECKVERSION</span>();</span><br><span class="line">ImGui::<span class="built_in">CreateContext</span>();</span><br><span class="line">ImGuiIO&amp; io = ImGui::<span class="built_in">GetIO</span>(); (<span class="type">void</span>)io;</span><br><span class="line"><span class="comment">//io.ConfigFlags |= ImGuiConfigFlags_NavEnableKeyboard;     // Enable Keyboard Controls</span></span><br><span class="line"><span class="comment">//io.ConfigFlags |= ImGuiConfigFlags_NavEnableGamepad;      // Enable Gamepad Controls</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Setup Dear ImGui style</span></span><br><span class="line">ImGui::<span class="built_in">StyleColorsDark</span>();</span><br><span class="line"><span class="comment">//ImGui::StyleColorsClassic();</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Setup Platform/Renderer backends</span></span><br><span class="line"><span class="built_in">ImGui_ImplGlfw_InitForOpenGL</span>(window, <span class="literal">true</span>);</span><br><span class="line"><span class="built_in">ImGui_ImplOpenGL3_Init</span>(glsl_version);</span><br></pre></td></tr></table></figure>

<p>和教程里面稍有变化（瑟瑟发抖，感觉坑会越来越多了，有点后悔），幸好和图形学课里的框架还是比较接近的，还算能参考一下。</p>
<p>助教的框架向上再封装了一层。这个教程这里大概是为了简单，直接写在了main函数里。</p>
<p>直接把上面的初始化复制上去，然后回头添加头文件</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;imgui/imgui.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;imgui/imgui_impl_glfw.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;imgui/imgui_impl_opengl3.h&gt;</span></span></span><br></pre></td></tr></table></figure>

<p>还有个glsl_version变量，在example里面是定义的。但是我们去这个函数里看一看，其实如果直接给NULL的话，是有默认值的。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">    <span class="comment">// Store GLSL version string so we can refer to it later in case we recreate shaders.</span></span><br><span class="line">    <span class="comment">// Note: GLSL version is NOT the same as GL version. Leave this to NULL if unsure.</span></span><br><span class="line">    <span class="keyword">if</span> (glsl_version == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line"><span class="meta">#<span class="keyword">if</span> defined(IMGUI_IMPL_OPENGL_ES2)</span></span><br><span class="line">        glsl_version = <span class="string">&quot;#version 100&quot;</span>;</span><br><span class="line"><span class="meta">#<span class="keyword">elif</span> defined(IMGUI_IMPL_OPENGL_ES3)</span></span><br><span class="line">        glsl_version = <span class="string">&quot;#version 300 es&quot;</span>;</span><br><span class="line"><span class="meta">#<span class="keyword">elif</span> defined(__APPLE__)</span></span><br><span class="line">        glsl_version = <span class="string">&quot;#version 150&quot;</span>;</span><br><span class="line"><span class="meta">#<span class="keyword">else</span></span></span><br><span class="line">        glsl_version = <span class="string">&quot;#version 130&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>并且注释很贴心地告诉我们，如果不确定glsl的版本，就直接留空</p>
<p>所以这个glsl_version变量我们直接删掉。</p>
<p>虽然和教程里面不一样，会多一些步骤，但像这样自己解决掉问题还是会很有成就感的吧，其实也不难对吧。</p>
<p>（实际上作者也跳过了里面io的初始化，这个我们也可以删掉）</p>
<p>然后是循环中的newframe步骤（作者仅需一行，我们这里变成了三行）</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Start the Dear ImGui frame</span></span><br><span class="line"><span class="built_in">ImGui_ImplOpenGL3_NewFrame</span>();</span><br><span class="line"><span class="built_in">ImGui_ImplGlfw_NewFrame</span>();</span><br><span class="line">ImGui::<span class="built_in">NewFrame</span>();</span><br></pre></td></tr></table></figure>

<p>关于位置，助教框架的做法是——先渲染画面，再渲染gui。这一部分放在一个renderframe函数中，向上封装的流程是——输入输出处理-renderframe-swapbuffer-pollEvent</p>
<p>这也很符合逻辑，我们就也把这部分放在交换缓冲之前好了。（其实作者提出放哪里都行，只要Imgui的代码是放在这里面end之前就好了）</p>
<p>然后我们添加render命令</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ImGui::<span class="built_in">Render</span>();</span><br><span class="line"><span class="built_in">ImGui_ImplOpenGL3_RenderDrawData</span>(ImGui::<span class="built_in">GetDrawData</span>());</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>在循环结束后，我们还要shutdown</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ImGui_ImplOpenGL3_Shutdown</span>();</span><br><span class="line"><span class="built_in">ImGui_ImplGlfw_Shutdown</span>();</span><br><span class="line">ImGui::<span class="built_in">DestroyContext</span>();</span><br></pre></td></tr></table></figure>

<p>然后关于gui里的具体内容我们就复制一下example的就好了</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">float</span> f = <span class="number">0.0f</span>;</span><br><span class="line">    <span class="type">static</span> <span class="type">int</span> counter = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    ImGui::<span class="built_in">Begin</span>(<span class="string">&quot;Hello, world!&quot;</span>);                          <span class="comment">// Create a window called &quot;Hello, world!&quot; and append into it.</span></span><br><span class="line"></span><br><span class="line">    ImGui::<span class="built_in">Text</span>(<span class="string">&quot;This is some useful text.&quot;</span>);               <span class="comment">// Display some text (you can use a format strings too)</span></span><br><span class="line">    ImGui::<span class="built_in">Checkbox</span>(<span class="string">&quot;Demo Window&quot;</span>, &amp;show_demo_window);      <span class="comment">// Edit bools storing our window open/close state</span></span><br><span class="line">    ImGui::<span class="built_in">Checkbox</span>(<span class="string">&quot;Another Window&quot;</span>, &amp;show_another_window);</span><br><span class="line"></span><br><span class="line">    ImGui::<span class="built_in">SliderFloat</span>(<span class="string">&quot;float&quot;</span>, &amp;f, <span class="number">0.0f</span>, <span class="number">1.0f</span>);            <span class="comment">// Edit 1 float using a slider from 0.0f to 1.0f</span></span><br><span class="line">    ImGui::<span class="built_in">ColorEdit3</span>(<span class="string">&quot;clear color&quot;</span>, (<span class="type">float</span>*)&amp;clear_color); <span class="comment">// Edit 3 floats representing a color</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (ImGui::<span class="built_in">Button</span>(<span class="string">&quot;Button&quot;</span>))                            <span class="comment">// Buttons return true when clicked (most widgets return true when edited/activated)</span></span><br><span class="line">        counter++;</span><br><span class="line">    ImGui::<span class="built_in">SameLine</span>();</span><br><span class="line">    ImGui::<span class="built_in">Text</span>(<span class="string">&quot;counter = %d&quot;</span>, counter);</span><br><span class="line"></span><br><span class="line">    ImGui::<span class="built_in">Text</span>(<span class="string">&quot;Application average %.3f ms/frame (%.1f FPS)&quot;</span>, <span class="number">1000.0f</span> / ImGui::<span class="built_in">GetIO</span>().Framerate, ImGui::<span class="built_in">GetIO</span>().Framerate);</span><br><span class="line">    ImGui::<span class="built_in">End</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>（还有三个小变量，直接复制一下就好了）</p>
<p>非常好用。</p>
<img src="https://raw.githubusercontent.com/XZYW7/PicGo/main/img/image-20220912001607129.png" alt="image-20220912001607129" style="zoom:50%;" />



<p>然后我们要开始改造自己需要的gui了。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">glm::mat4 model = glm::<span class="built_in">translate</span>(glm::<span class="built_in">mat4</span>(<span class="number">1.0f</span>), translation);</span><br><span class="line">glm::mat4 mvp = proj * view * model;</span><br><span class="line"><span class="comment">//...</span></span><br><span class="line">&#123;</span><br><span class="line">ImGui::<span class="built_in">Begin</span>(<span class="string">&quot;Hello, world!&quot;</span>);</span><br><span class="line">ImGui::<span class="built_in">SliderFloat3</span>(<span class="string">&quot;Translation&quot;</span>, &amp;translation.x, <span class="number">-2.0f</span>, <span class="number">2.0f</span>);</span><br><span class="line"></span><br><span class="line">ImGui::<span class="built_in">Text</span>(<span class="string">&quot;Application average %.3f ms/frame (%.1f FPS)&quot;</span>, <span class="number">1000.0f</span> / ImGui::<span class="built_in">GetIO</span>().Framerate, ImGui::<span class="built_in">GetIO</span>().Framerate);</span><br><span class="line">ImGui::<span class="built_in">End</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>我们把model的修改移动到主循环当中，也非常好用。</p>
<p>这里我们使用的Float3，只提供了第一个translation.x 的指针。在使用的时候我们也要注意，glm::vec3这种结构储存的数据在内存上是不是连续的。</p>
<img src="https://raw.githubusercontent.com/XZYW7/PicGo/main/img/image-20220912003032134.png" alt="image-20220912003032134" style="zoom:50%;" />



<h2 id="23-Rendering-Multiple-Objects"><a href="#23-Rendering-Multiple-Objects" class="headerlink" title="23 Rendering Multiple Objects"></a><strong>23 Rendering Multiple Objects</strong></h2><p>回顾我们之前的drawcall的部分，主要是这几个步骤</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">shader.<span class="built_in">Bind</span>();</span><br><span class="line">va.<span class="built_in">Bind</span>();</span><br><span class="line">ib.<span class="built_in">Bind</span>();</span><br><span class="line"><span class="built_in">GLCall</span>(<span class="built_in">glDrawElements</span>(GL_TRIANGLES, ib.<span class="built_in">GetCount</span>(), GL_UNSIGNED_INT, <span class="literal">nullptr</span>));</span><br></pre></td></tr></table></figure>

<p>分析shader当中，我们想要画出另一个位置的物体，我们可以提供一个不同的vertex buffer</p>
<p>那么当然也可以使用另一个mvp（这当然也更快）。</p>
<p> 当我们要绘制同一个物体很多次时（如tile类型的这种东西）我们没有必要用for loop像这样去绘制很多次，而是可以用&#x3D;&#x3D;batching&#x3D;&#x3D; 合批的方法，只调用一次drawcall，把所有的东西放到一个vertex buffer里。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/09/12/TA/OpenGL/Opengl%20learning_03/" data-id="cmffhkuae001lg0uh62pj467y" class="article-share-link">
        Share
      </a>
      
<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Computer-Graphics/" rel="tag">Computer Graphics</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Opengl/" rel="tag">Opengl</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%AC%94%E8%AE%B0/" rel="tag">笔记</a></li></ul>

    </footer>

  </div>

  
  
<nav class="article-nav">
  
  <a href="/2022/09/24/TA/OpenGL/Opengl%20learning_04/" class="article-nav-link">
    <strong class="article-nav-caption">Newer</strong>
    <div class="article-nav-title">
      
      【笔记】Cherno Opengl Tutorial note 04
      
    </div>
  </a>
  
  
  <a href="/2022/09/10/TA/OpenGL/Opengl%20learning_02/" class="article-nav-link">
    <strong class="article-nav-caption">Older</strong>
    <div class="article-nav-title">【笔记】Cherno Opengl Tutorial note 02</div>
  </a>
  
</nav>

  

  
  
  
  

</article>
</section>
    <footer class="footer">
  <div class="outer">
    <ul class="list-inline">
      <li>XZYW7&#39;s Blog &copy; 2025</li>
      
        <li>
          
            <a href="https://beian.miit.gov.cn/" target="_blank"></a>
            
        </li>
      
      <li>Powered by <a href="http://hexo.io/" target="_blank">Hexo</a></li>
      <li>theme  <a target="_blank" rel="noopener" href="https://github.com/zhwangart/hexo-theme-ocean">Ocean</a></li>
    </ul>
    <p><ul class="list-inline">
  
  <li><i class="fe fe-smile-alt tooltip" data-tooltip="UV"></i> <span id="busuanzi_value_site_uv"></span></li>
  
  <li><i class="fe fe-bookmark tooltip" data-tooltip="PV"></i> <span id="busuanzi_value_page_pv"></span></li>
  
</ul></p>
  </div>
</footer>
  </main>
  <aside class="sidebar">
    <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <div class="logo">
    <a href="/"><img src="/images/hexo.svg" alt="XZYW7&#39;s Blog"></a>
  </div>
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">Home</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/gallery">Gallery</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/about">About</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/archives">Archives</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link nav-item-search" title="Search">
        <i class="fe fe-search"></i>
        Search
      </a>
    </li>
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      <div class="totop" id="totop">
  <i class="fe fe-rocket"></i>
</div>
    </li>
    <li class="nav-item">
      
      <a class="nav-item-link" target="_blank" href="/atom.xml" title="RSS Feed">
        <i class="fe fe-feed"></i>
      </a>
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
  </aside>
  
<script src="/js/jquery-2.0.3.min.js"></script>


<script src="/js/jquery.justifiedGallery.min.js"></script>


<script src="/js/lazyload.min.js"></script>


<script src="/js/busuanzi-2.3.pure.min.js"></script>



<script src="/fancybox/jquery.fancybox.min.js"></script>





<script src="/js/tocbot.min.js"></script>


<script>
  // Tocbot_v4.7.0  http://tscanlin.github.io/tocbot/
  tocbot.init({
    tocSelector: '.tocbot',
    contentSelector: '.article-entry',
    headingSelector: 'h1, h2, h3, h4, h5, h6',
    hasInnerContainers: true,
    scrollSmooth: true,
    positionFixedSelector: '.tocbot',
    positionFixedClass: 'is-position-fixed',
    fixedSidebarOffset: 'auto',
  });
</script>



<script src="/js/ocean.js"></script>

</body>

</html>